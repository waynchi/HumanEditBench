plik = open("dane_obrazki.txt")
maxbitybledne = 0
bityBledne = list()

def czyPoprawny(obrazek): 
    for wiersz in obrazek[:-1]: 
        if wiersz[:-1].count('1') % 2 != int(wiersz[-1]):
            return False
    for i in range(20): 
        kolumna = ""
        for j in range(21):  
            kolumna+=obrazek[j][i]
        if kolumna[:-1].count('1')% 2 != int(kolumna[-1]):
            return False
    return True

def czyNaprawialny(obrazek):
    bityKolBleden = 0
    bityWierBledne = 0
    for wiersz in obrazek[:-1]: 
        if wiersz[:-1].count('1') % 2 != int(wiersz[-1]):
            bityWierBledne+=1
    for i in range(20): 
        kolumna = ""
        for j in range(21):  
            kolumna+=obrazek[j][i]
        if kolumna[:-1].count('1')% 2 != int(kolumna[-1]):
           bityKolBleden+=1
    global maxbitybledne
    if maxbitybledne<(bityKolBleden+bityWierBledne):
        maxbitybledne = bityKolBleden+bityWierBledne
    bityBledne.append(bityKolBleden+bityWierBledne)

    if bityWierBledne >1 :
        return False
    if bityKolBleden > 1:
        return False

    return True

def napraw(obrazek):
    bityWierBledne = []
    bityKolBledne = []
    
    for i, wiersz in enumerate(obrazek[:-1]):
        if wiersz[:-1].count('1') % 2 != int(wiersz[-1]):
            bityWierBledne.append(i)
            
    for i in range(20): 
        kolumna = ""
        for j in range(21):  
            kolumna+=obrazek[j][i]
        if kolumna[:-1].count('1')% 2 != int(kolumna[-1]):
            bityKolBledne.append(i)
            
    obrazekPoprawiony = [list(wiersz) for wiersz in obrazek]
    
    if bityWierBledne:
        wierszDoZmiany = bityWierBledne[0]
        obrazekPoprawiony[wierszDoZmiany] = list(obrazekPoprawiony[wierszDoZmiany])
        obrazekPoprawiony[wierszDoZmiany][-1] = str(1 - int(obrazekPoprawiony[wierszDoZmiany][-1]))
        
    if bityKolBledne:
        kolumnaDoZmiany = bityKolBledne[0]
        for i in range(21):
            obrazekPoprawiony[i][kolumnaDoZmiany] = str(1 - int(obrazekPoprawiony[i][kolumnaDoZmiany]))
            
    obrazekBledny = [''.join(wiersz) for wiersz in obrazek]
    obrazekPoprawiony = [''.join(wiersz) for wiersz in obrazekPoprawiony]
    
    return [obrazekBledny, obrazekPoprawiony]

poprawne = 0
naprawialne = 0
obrazek = list()
for linia in plik:
    wiersz = linia.strip() 
    obrazek.append(wiersz)
    if len(obrazek) == 21: 
        if czyPoprawny(obrazek):
            poprawne+=1
        elif czyNaprawialny(obrazek):
            naprawialne+=1
            obrazekBledny, obrazekPoprawiony = napraw(obrazek)
            print("Obrazek bledny:")
            for wiersz in obrazekBledny:
                print(wiersz)
            print("Obrazek poprawiony:")
            for wiersz in obrazekPoprawiony:
                print(wiersz)


    if len(obrazek) == 22:  
        obrazek = list()

print(poprawne,naprawialne,200-poprawne-naprawialne)
print(maxbitybledne,max(bityBledne))