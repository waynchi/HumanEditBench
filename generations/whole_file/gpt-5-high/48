import requests


def registerKey(key: str, user: str):
    print(f'chave: {key}\nnome: {user}')
    try:
        # Use POST request with JSON payload
        response = requests.post('http://127.0.0.1:5000/register', json={'key': key, 'user': user})

        # Attempt to parse JSON response
        try:
            data = response.json()
        except ValueError:
            data = {}

        # Prefer explicit 'valid' flag from the response, if present
        if isinstance(data, dict) and 'valid' in data:
            return bool(data['valid'])

        # Fallback to HTTP status code if no 'valid' field is present
        return response.status_code == 200

    except requests.RequestException as e:
        print(f"Erro de conex√£o: {e}")
        return False