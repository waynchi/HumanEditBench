import asyncio
from aiogram import Bot, Dispatcher, F
from aiogram.types import Message, CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton
import time

token = "TOKEN"
bot = Bot(token=token)
dp = Dispatcher()
id = 111111111
time_time = 5

b = bool(True)

@dp.message(F.command() == 'start')
async def start(message: Message):
    markup = InlineKeyboardMarkup(row_width=2)
    markup = InlineKeyboardMarkup(inline_keyboard = [
        [InlineKeyboardButton(text="Да", callback_data="stop"),
        InlineKeyboardButton(text="Нет", callback_data="continue")]
        ])
    await bot.send_message(chat_id=id, text="Ты робот?", reply_markup=markup)

@dp.callback_query(F.data == "stop")
async def stop(call: CallbackQuery):
    global b
    # b = False
    # await bot.send_message(chat_id=call.message.chat.id, text="Bien hecho, tonto")
    await bot.send_message(chat_id=call.message.chat.id, text="<obscene message>!")

@dp.callback_query(F.data == "continue")
async def stop(call: CallbackQuery):
    await bot.send_message(chat_id=call.message.chat.id, text="Лох^лох, лох")

@dp.message(F.text)
async def handle_all_messages(message: Message):
    with open(r"D:\Python files\!MoexApiBot\censored.gif", "rb") as vid:
        await bot.send_video(chat_id=id, video=vid, caption="Го <censor> ёр селф")

async def send_periodic_messages():
    while b:
        await bot.send_message(chat_id=id, text="Лох лох")
        with open(r"D:\Python files\!MoexApiBot\Shocked13.mp4", "rb") as vid:
            await bot.send_video(chat_id=id, video=vid, caption="Ты проиграл")
        await asyncio.sleep(time_time)

async def on_startup():
    print('Бот запущен!')
    asyncio.create_task(send_periodic_messages())

async def main():
    await on_startup()
    await dp.start_polling(bot, allowed_updates=dp.resolve_used_update_types())

if __name__ == '__main__':
    asyncio.run(main())