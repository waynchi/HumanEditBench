
python
    steps_per_epoch = total_train_examples // batch_size
    eval_steps = max(1, steps_per_epoch // 10)
    save_steps = steps_per_epoch
    logging_steps = max(1, steps_per_epoch // 20)

    training_args = TrainingArguments(
        output_dir=checkpoint_dir,
        learning_rate=learning_rate,
        per_device_train_batch_size=batch_size,
        per_device_eval_batch_size=batch_size,
        num_train_epochs=num_epochs,
        eval_steps=eval_steps,
        save_steps=save_steps,
        logging_steps=logging_steps,
        save_total_limit=2,
        weight_decay=0.01,
        evaluation_strategy="steps",
        logging_strategy="steps",
        save_strategy="steps",
        logging_dir=logging_dir,
        report_to="none",
        load_best_model_at_end=True,
    )