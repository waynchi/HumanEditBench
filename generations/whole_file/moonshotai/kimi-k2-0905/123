import os
from pymilvus import connections, FieldSchema, CollectionSchema, DataType, Collection

# Record the current path as cwd
# Create vector database path
cwd = os.getcwd()
db_path = cwd + '/milvus_db.db'
TABLE_NAME = 'test_table'
DIM_VALUE = 128

# Connect to Milvus using the default local server
connections.connect("default", host="localhost", port="19530")

# Create collection schema
fields = [
    FieldSchema(name="id", dtype=DataType.INT64, is_primary=True, auto_id=True),
    FieldSchema(name="vector", dtype=DataType.FLOAT_VECTOR, dim=DIM_VALUE)
]
schema = CollectionSchema(fields, description="Test collection for Milvus")

# Create collection or get existing one
if not utility.has_collection(TABLE_NAME):
    client = Collection(name=TABLE_NAME, schema=schema)
else:
    client = Collection(name=TABLE_NAME)