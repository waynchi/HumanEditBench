# Import Pymapdl
# from ansys.mapdl.core import launch_mapdl

# Create a MAPDL instance
# mapdl = launch_mapdl(override=True)

# Define a function to fit a line to an array def fit_line(x, y):
import numpy as np

def fit_line(x, y):
    """Function to fit a line to an array"""
    # Calculate the average values of x and y
    x_mean = np.mean(x)
    y_mean = np.mean(y)
    
    # Calculate the deviation of x and y
    x_dev = x - x_mean
    y_dev = y - y_mean
    
    # Calculate the product of the deviations of x and y
    xy_dev = x_dev * y_dev
    
    # Calculate the square of the deviation of x
    x_dev_squared = x_dev ** 2
    
    # Calculate the slope and intercept of the line
    slope = np.sum(xy_dev) / np.sum(x_dev_squared)
    intercept = y_mean - slope * x_mean
    
    return slope, intercept

# Define a function for quadratic curve fitting of the xy array
def fit_quadratic(x, y):
    """Function to perform quadratic curve fitting on arrays and return the maximum deviation"""
    # Create a Vandermonde matrix
    A = np.vstack([x**2, x, np.ones(len(x))]).T
    
    # Use the least squares method to solve for coefficients
    coeffs = np.linalg.lstsq(A, y, rcond=None)[0]
    
    # Compute fitted values
    y_fitted = np.dot(A, coeffs)
    
    # Calculate residuals
    residuals = y - y_fitted
    
    # Find the maximum absolute deviation
    max_deviation = np.max(np.abs(residuals))
    
    return coeffs, max_deviation