from langchain_ollama.chat_models import ChatOllama
from langchain.schema import SystemMessage, HumanMessage
import json

# Load the SHAP values from JSON file
with open("Vuori_Final_Approval_2024_09_24.json", "r") as file:
    shap_values_json = json.load(file).get("shap_values")

# Load the system prompt
with open("system.prompt", "r") as file:
    sys_prompt = file.read().strip()

# Create the prompt with SHAP values
prompt = f"""
{shap_values_json}
"""

# Initialize the ChatOllama model
llm = ChatOllama(model="llama3.2", base_url="http://localhost:11434")

# Create messages for the chat
messages = [
    SystemMessage(content=sys_prompt),
    HumanMessage(content=prompt)
]

# Get response from the model
response = llm.invoke(messages)

# Print the response content
print(response.content)